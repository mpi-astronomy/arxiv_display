<div class="macros" style="visibility:hidden;">
$\newcommand{\ensuremath}{}$
$\newcommand{\xspace}{}$
$\newcommand{\object}[1]{\texttt{#1}}$
$\newcommand{\farcs}{{.}''}$
$\newcommand{\farcm}{{.}'}$
$\newcommand{\arcsec}{''}$
$\newcommand{\arcmin}{'}$
$\newcommand{\ion}[2]{#1#2}$
$\newcommand{\textsc}[1]{\textrm{#1}}$
$\newcommand{\hl}[1]{\textrm{#1}}$
$\newcommand{\footnote}[1]{}$
$\newcommand{\cmark}{\ding{51}}$
$\newcommand{\xmark}{\ding{55}}$
$\newcommand{\LM}[1]{{\color{blue}LM: #1}}$
$\newcommand{\thebibliography}{\DeclareRobustCommand{\VAN}[3]{##3}\VANthebibliography}$</div>



<div id="title">

# Learning the Cosmic Web: Graph-based Classification of Simulated Galaxies by their Dark Matter Environments

</div>
<div id="comments">

[![arXiv](https://img.shields.io/badge/arXiv-2512.05909-b31b1b.svg)](https://arxiv.org/abs/2512.05909)<mark>Appeared on: 2025-12-08</mark> -  _15 pages, 7 figures, 9 tables, submitted to Royal Astronomical Society Techniques and Instruments_

</div>
<div id="authors">

D. Kololgi, <mark>K. Naidoo</mark>, A. Saintonge, O. Lahav

</div>
<div id="abstract">

**Abstract:** We present a novel graph-based machine learning classifier for identifying the dark matter cosmic web environments of galaxies. Large galaxy surveys offer comprehensive statistical views of how galaxy properties are shaped by large-scale structure, but this requires robust classifications of galaxies' cosmic web environments. Using stellar mass-selected IllustrisTNG-300 galaxies, we apply a three-stage, simulation-based framework to link galaxies to the total (mainly dark) underlying matter distribution. Here, we apply the following three steps: First, we assign the positions of simulated galaxies to a void, wall, filament, or cluster environment using the T-Web classification of the underlying matter distribution. Second, we construct a Delaunay triangulation of the galaxy distribution to summarise the local geometric structure with ten graph metrics for each galaxy. Third, we train a graph attention network (GAT) on each galaxy's graph metrics to predict its cosmic web environment. For galaxies with stellar mass $\mathrm{>10^9 M_{\odot}}$ , our GAT+ model achieves an accuracy of $85 \%$ , outperforming graph-agnostic multilayer perceptrons and graph convolutional networks. Our results demonstrate that graph-based representations of galaxy positions provide a powerful and physically meaningful way to infer dark matter environments. We plan to apply this simulation-based graph modelling to investigate how the properties of observed galaxies from the Dark Energy Spectroscopic Instrument (DESI) survey are influenced by their dark matter environments.

</div>

<div id="div_fig1">

<img src="tmp_2512.05909/./Figures/MLP_GNN_GATPlus.png" alt="Fig5" width="100%"/>

**Figure 5. -** Overview of the baseline and graph-based neural network architectures explored in this work.
The MLP (left) serves as the baseline model, taking node features as independent inputs passed through successive fully-connected layers. The GCN (middle) introduces relational inductive biases by aggregating information from connected nodes in the Delaunay graph, enabling feature propagation along edges. The GAT+ (right) extends this by applying multi-head attention mechanisms and edge features, allowing the network to learn the relative importance of neighbouring nodes. The architectures were refined through iterative experimentation, adjusting the number of layers, hidden dimensions, and normalisation or dropout configurations until convergence performance and stability were optimised across validation runs. (*fig:mlpgnngatplusarchitecture*)

</div>
<div id="div_fig2">

<img src="tmp_2512.05909/./Figures/umap_gat_embeddings_test_predictions.png" alt="Fig7" width="100%"/>

**Figure 7. -** UMAP projections into three-dimensions represented by the columns. Top row: UMAP contours of the GAT+ embeddings, but only limited to the test galaxy set and coloured by the model-predicted environments. Bottom row: GAT+ embeddings of the test galaxy set in UMAP projected space. Darker edges represent higher model uncertainty, which is derived from the Shannon entropy of the output probabilities. The overlap of cosmic web environments in the top figure corresponds with regions of high model uncertainty given by the bottom figure, indicating that the GAT+ model learns a physically meaningful representation of the cosmic web. (*fig:UMAP*)

</div>
<div id="div_fig3">

<img src="tmp_2512.05909/./Figures/training_validation_accuracies_losses.png" alt="Fig6" width="100%"/>

**Figure 6. -** Training and validation performance of the GAT+ model. Accuracy (left) and loss (right) curves are shown for the training and validation datasets over 10,000 epochs for the $\mathrm{10^{9} M_{\odot}}$ stellar mass cut. The convergence and close overlap between training and validation curves indicate stable optimisation and minimal overfitting. (*fig:gat_4H_plus_10_9_loss_accuracy_curves*)

</div><div id="qrcode"><img src=https://api.qrserver.com/v1/create-qr-code/?size=100x100&data="https://arxiv.org/abs/2512.05909"></div>